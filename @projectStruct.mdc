# Next.js API å­¦ä¹ é¡¹ç›® - é¡¹ç›®ç»“æ„è§„èŒƒ

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªç”¨äºå­¦ä¹  Next.js 15 APIã€Tailwind CSS å’Œ shadcn/ui çš„é¡¹ç›®ã€‚

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 15 (App Router)
- **æ ·å¼**: Tailwind CSS 4
- **UI ç»„ä»¶**: shadcn/ui
- **åŒ…ç®¡ç†å™¨**: pnpm
- **è¯­è¨€**: TypeScript

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app/                 # Next.js App Router é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx      # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx        # é¦–é¡µ
â”‚   â”œâ”€â”€ globals.css     # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ ssr/            # SSR ç¤ºä¾‹é¡µé¢
â”‚   â”œâ”€â”€ ssg/            # SSG ç¤ºä¾‹é¡µé¢
â”‚   â”œâ”€â”€ isr/            # ISR ç¤ºä¾‹é¡µé¢
â”‚   â””â”€â”€ client-server-test/  # å®¢æˆ·ç«¯æœåŠ¡ç«¯ç»„ä»¶æµ‹è¯•é¡µé¢
â”œâ”€â”€ components/          # shadcn/ui åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ ui/             # shadcn/ui ç»„ä»¶åº“
â”‚   â””â”€â”€ ThemeToggle.tsx # å…¨å±€ä¸»é¢˜åˆ‡æ¢ç»„ä»¶
â”œâ”€â”€ features/           # åŠŸèƒ½æ¨¡å—ç»„ä»¶ï¼ˆæ ¸å¿ƒç»„ç»‡åŸåˆ™ï¼‰
â”‚   â”œâ”€â”€ ssr/           # SSR è·¯ç”±ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ ssg/           # SSG è·¯ç”±ç›¸å…³ç»„ä»¶
â”‚   â””â”€â”€ isr/           # ISR è·¯ç”±ç›¸å…³ç»„ä»¶
â””â”€â”€ lib/                # å·¥å…·å‡½æ•°
    â””â”€â”€ utils.ts        # é€šç”¨å·¥å…·å‡½æ•°
```

## ç»„ä»¶ç»„ç»‡è§„èŒƒ

### 1. Features ç»„ä»¶ç»„ç»‡æ ¸å¿ƒè§„åˆ™

**é‡è¦åŸåˆ™ï¼šæ‰€æœ‰é¡µé¢ç‰¹å®šçš„ç»„ä»¶éƒ½åº”è¯¥å†™åˆ° `features` å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸‹ã€‚**

#### 1.1 æŒ‰è·¯ç”±åˆ†ç»„ç»„ç»‡

```
features/
â”œâ”€â”€ ssr/                    # /ssr è·¯ç”±ç›¸å…³çš„æ‰€æœ‰ç»„ä»¶
â”‚   â”œâ”€â”€ index.ts           # ç»Ÿä¸€å¯¼å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ RefreshButton.tsx  # SSR é¡µé¢ä¸“ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ Separator.tsx      # SSR é¡µé¢åˆ†éš”ç¬¦ç»„ä»¶
â”‚   â”œâ”€â”€ ServerComponent.tsx           # æœåŠ¡ç«¯ç»„ä»¶ç¤ºä¾‹
â”‚   â”œâ”€â”€ ClientWithServerComponent.tsx # å®¢æˆ·ç«¯ç»„ä»¶ç¤ºä¾‹
â”‚   â”œâ”€â”€ BrokenClientComponent.tsx     # é”™è¯¯ç¤ºä¾‹ç»„ä»¶
â”‚   â”œâ”€â”€ CorrectSolution.tsx          # æ­£ç¡®è§£å†³æ–¹æ¡ˆç»„ä»¶
â”‚   â””â”€â”€ ClientCounter.tsx            # å®¢æˆ·ç«¯è®¡æ•°å™¨ç»„ä»¶
â”œâ”€â”€ ssg/                    # /ssg è·¯ç”±ç›¸å…³çš„æ‰€æœ‰ç»„ä»¶
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ [SGGç›¸å…³ç»„ä»¶].tsx
â”œâ”€â”€ isr/                    # /isr è·¯ç”±ç›¸å…³çš„æ‰€æœ‰ç»„ä»¶
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ ISRInfoCard.tsx
â”‚   â”œâ”€â”€ NewsCard.tsx
â”‚   â”œâ”€â”€ StatsCard.tsx
â”‚   â””â”€â”€ WeatherCard.tsx
â””â”€â”€ [route-name]/          # å…¶ä»–è·¯ç”±å¯¹åº”çš„ç»„ä»¶
    â”œâ”€â”€ index.ts
    â””â”€â”€ [ç»„ä»¶æ–‡ä»¶].tsx
```

#### 1.2 ç»„ä»¶åˆ†ç±»è§„åˆ™

**ğŸ“ Features æ–‡ä»¶å¤¹ä¸‹çš„ç»„ä»¶ç±»å‹ï¼š**

1. **é¡µé¢ç‰¹å®šç»„ä»¶** - åªåœ¨ç‰¹å®šè·¯ç”±é¡µé¢ä½¿ç”¨çš„ç»„ä»¶
2. **åŠŸèƒ½ç»„ä»¶** - å®ç°ç‰¹å®šåŠŸèƒ½é€»è¾‘çš„ç»„ä»¶ï¼ˆå¦‚æ•°æ®å±•ç¤ºã€ç”¨æˆ·äº¤äº’ï¼‰
3. **å¸ƒå±€ç»„ä»¶** - é¡µé¢å†…çš„å¸ƒå±€ç›¸å…³ç»„ä»¶
4. **ä¸šåŠ¡é€»è¾‘ç»„ä»¶** - åŒ…å«ç‰¹å®šä¸šåŠ¡é€»è¾‘çš„ç»„ä»¶

**ğŸ“ Components/ui æ–‡ä»¶å¤¹ä¸‹çš„ç»„ä»¶ç±»å‹ï¼š**

1. **åŸºç¡€ UI ç»„ä»¶** - shadcn/ui ç»„ä»¶åº“
2. **é€šç”¨ç»„ä»¶** - è·¨å¤šä¸ªé¡µé¢ä½¿ç”¨çš„åŸºç¡€ç»„ä»¶

**ğŸ“ Components æ ¹ç›®å½•ä¸‹çš„ç»„ä»¶ç±»å‹ï¼š**

1. **å…¨å±€ç»„ä»¶** - æ•´ä¸ªåº”ç”¨çº§åˆ«çš„ç»„ä»¶ï¼ˆå¦‚ ThemeToggleï¼‰
2. **å¸ƒå±€ç»„ä»¶** - å…¨å±€å¸ƒå±€ç›¸å…³ç»„ä»¶

### 2. æ–‡ä»¶ç»„ç»‡ç»“æ„

#### 2.1 æ¯ä¸ª features å­æ–‡ä»¶å¤¹å¿…é¡»åŒ…å«

```typescript
// features/[route-name]/index.ts
/**
 * [Route Name] åŠŸèƒ½ç»„ä»¶é›†åˆ
 * åŒ…å« [route-name] é¡µé¢ç›¸å…³çš„æ‰€æœ‰ç»„ä»¶
 */

export { ComponentA } from './ComponentA';
export { ComponentB } from './ComponentB';
// ... å…¶ä»–ç»„ä»¶å¯¼å‡º
```

#### 2.2 ç»„ä»¶æ–‡ä»¶å‘½åè§„èŒƒ

- **ç»„ä»¶æ–‡ä»¶**: ä½¿ç”¨ PascalCase: `RefreshButton.tsx`ã€`ServerComponent.tsx`
- **åŠŸèƒ½æ–‡ä»¶å¤¹**: ä½¿ç”¨è·¯ç”±åç§°: `ssr/`ã€`ssg/`ã€`isr/`
- **å¯¼å‡ºæ–‡ä»¶**: å›ºå®šä½¿ç”¨ `index.ts`

### 3. å¯¼å…¥ä½¿ç”¨è§„èŒƒ

#### 3.1 æ­£ç¡®çš„å¯¼å…¥æ–¹å¼

```typescript
// âœ… ä»å¯¹åº”è·¯ç”±çš„ features å¯¼å…¥é¡µé¢ç‰¹å®šç»„ä»¶
import { RefreshButton, Separator, ServerComponent } from '@/features/ssr';

// âœ… ä»åŸºç¡€ UI ç»„ä»¶åº“å¯¼å…¥é€šç”¨ç»„ä»¶
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';

// âœ… ä»å…¨å±€ç»„ä»¶å¯¼å…¥
import { ThemeToggle } from '@/components/ThemeToggle';
```

#### 3.2 é”™è¯¯çš„ç»„ç»‡æ–¹å¼

```typescript
// âŒ ä¸è¦æŠŠé¡µé¢ç‰¹å®šç»„ä»¶æ”¾åˆ°å…¨å±€ components
import { RefreshButton } from '@/components/RefreshButton'; // é”™è¯¯ï¼

// âŒ ä¸è¦è·¨è·¯ç”±å¯¼å…¥å…¶ä»–è·¯ç”±çš„ç‰¹å®šç»„ä»¶
import { SSRSpecificComponent } from '@/features/ssr'; // åœ¨ ISR é¡µé¢ä¸­ä½¿ç”¨
```

### 4. ç»„ä»¶åˆ›å»ºæŒ‡å¯¼åŸåˆ™

#### 4.1 åˆ›å»ºæ–°ç»„ä»¶æ—¶çš„å†³ç­–æµç¨‹

1. **é—®ï¼šè¿™ä¸ªç»„ä»¶æ˜¯å¦åªåœ¨ç‰¹å®šè·¯ç”±é¡µé¢ä½¿ç”¨ï¼Ÿ**
   - æ˜¯ â†’ æ”¾å…¥å¯¹åº”çš„ `features/[route-name]/` æ–‡ä»¶å¤¹
   - å¦ â†’ ç»§ç»­ä¸‹ä¸€æ­¥

2. **é—®ï¼šè¿™ä¸ªç»„ä»¶æ˜¯å¦æ˜¯åŸºç¡€ UI ç»„ä»¶ï¼Ÿ**
   - æ˜¯ â†’ è€ƒè™‘ä½¿ç”¨ shadcn/ui æˆ–æ”¾å…¥ `components/ui/`
   - å¦ â†’ ç»§ç»­ä¸‹ä¸€æ­¥

3. **é—®ï¼šè¿™ä¸ªç»„ä»¶æ˜¯å¦æ˜¯å…¨å±€çº§åˆ«çš„ï¼Ÿ**
   - æ˜¯ â†’ æ”¾å…¥ `components/` æ ¹ç›®å½•
   - å¦ â†’ é‡æ–°è¯„ä¼°ç»„ä»¶ç”¨é€”

#### 4.2 ç»„ä»¶ç±»å‹æŒ‡å¯¼

```typescript
// ğŸ“ features/ssr/ServerComponent.tsx
/**
 * æœåŠ¡ç«¯ç»„ä»¶ç¤ºä¾‹ - SSR é¡µé¢ä¸“ç”¨
 * åªåœ¨ SSR ç›¸å…³é¡µé¢ä¸­ä½¿ç”¨
 */
export async function ServerComponent() {
  // æœåŠ¡ç«¯é€»è¾‘
}

// ğŸ“ features/ssr/ClientCounter.tsx
/**
 * å®¢æˆ·ç«¯è®¡æ•°å™¨ç»„ä»¶ - SSR é¡µé¢ä¸“ç”¨
 * åŒ…å«å®¢æˆ·ç«¯äº¤äº’é€»è¾‘ï¼Œåªåœ¨ SSR ç›¸å…³åŠŸèƒ½ä¸­ä½¿ç”¨
 */
('use client');
export function ClientCounter() {
  // å®¢æˆ·ç«¯äº¤äº’é€»è¾‘
}

// ğŸ“ components/ui/button.tsx
/**
 * åŸºç¡€æŒ‰é’®ç»„ä»¶ - å…¨å±€å¯ç”¨
 * shadcn/ui ç»„ä»¶ï¼Œå¯åœ¨ä»»æ„é¡µé¢ä½¿ç”¨
 */
export function Button() {
  // åŸºç¡€ UI é€»è¾‘
}

// ğŸ“ components/ThemeToggle.tsx
/**
 * ä¸»é¢˜åˆ‡æ¢ç»„ä»¶ - å…¨å±€çº§åˆ«
 * æ•´ä¸ªåº”ç”¨çº§åˆ«çš„åŠŸèƒ½ç»„ä»¶
 */
('use client');
export function ThemeToggle() {
  // å…¨å±€ä¸»é¢˜é€»è¾‘
}
```

### 5. å¼€å‘å·¥ä½œæµç¨‹

#### 5.1 æ–°å¢è·¯ç”±é¡µé¢æ—¶

1. åœ¨ `app/` ä¸‹åˆ›å»ºè·¯ç”±é¡µé¢
2. åœ¨ `features/` ä¸‹åˆ›å»ºå¯¹åº”çš„æ–‡ä»¶å¤¹
3. åˆ›å»º `index.ts` å¯¼å‡ºæ–‡ä»¶
4. åœ¨å¯¹åº” features æ–‡ä»¶å¤¹ä¸‹å¼€å‘é¡µé¢ç‰¹å®šç»„ä»¶

#### 5.2 å¼€å‘é¡µé¢ç»„ä»¶æ—¶

```typescript
// Step 1: åœ¨ features/[route-name]/ ä¸‹åˆ›å»ºç»„ä»¶
// features/ssr/NewComponent.tsx
export function NewComponent() {
  return <div>æ–°ç»„ä»¶</div>;
}

// Step 2: åœ¨ index.ts ä¸­æ·»åŠ å¯¼å‡º
// features/ssr/index.ts
export { NewComponent } from './NewComponent';

// Step 3: åœ¨é¡µé¢ä¸­ä½¿ç”¨
// app/ssr/page.tsx
import { NewComponent } from '@/features/ssr';
```

### 6. ç»„ä»¶è¾¹ç•Œå’ŒèŒè´£

#### 6.1 æœåŠ¡ç«¯ç»„ä»¶ vs å®¢æˆ·ç«¯ç»„ä»¶

```typescript
// âœ… æœåŠ¡ç«¯ç»„ä»¶ï¼šæ•°æ®è·å–ã€å¼‚æ­¥æ“ä½œ
export async function ServerComponent() {
  const data = await fetchData();
  return <div>{data}</div>;
}

// âœ… å®¢æˆ·ç«¯ç»„ä»¶ï¼šç”¨æˆ·äº¤äº’ã€çŠ¶æ€ç®¡ç†
'use client';
export function ClientComponent() {
  const [state, setState] = useState();
  return <button onClick={() => setState()}>äº¤äº’</button>;
}

// âŒ ä¸è¦åœ¨å®¢æˆ·ç«¯ç»„ä»¶ä¸­ç›´æ¥æ¸²æŸ“æœåŠ¡ç«¯ç»„ä»¶
'use client';
export function WrongComponent() {
  return <ServerComponent />; // é”™è¯¯ï¼
}

// âœ… æ­£ç¡®çš„ç»„åˆæ–¹å¼ï¼šåœ¨æœåŠ¡ç«¯ç»„ä»¶ä¸­ç»„åˆ
export function CorrectComposition() {
  return (
    <div>
      <ServerComponent />
      <ClientComponent />
    </div>
  );
}
```

### 7. æœ€ä½³å®è·µæ€»ç»“

1. **ä¸¥æ ¼æŒ‰è·¯ç”±ç»„ç»‡ç»„ä»¶** - æ¯ä¸ªè·¯ç”±çš„ç»„ä»¶éƒ½æ”¾åœ¨å¯¹åº”çš„ features æ–‡ä»¶å¤¹
2. **æ˜ç¡®ç»„ä»¶è¾¹ç•Œ** - åŒºåˆ†é¡µé¢ç‰¹å®šç»„ä»¶å’Œå…¨å±€ç»„ä»¶
3. **ç»Ÿä¸€å¯¼å‡ºç®¡ç†** - ä½¿ç”¨ index.ts ç»Ÿä¸€ç®¡ç†ç»„ä»¶å¯¼å‡º
4. **æ¸…æ™°çš„ç»„ä»¶èŒè´£** - æ¯ä¸ªç»„ä»¶æœ‰æ˜ç¡®çš„åŠŸèƒ½å’Œä½¿ç”¨åœºæ™¯
5. **éµå¾ª Next.js æ¸²æŸ“è¾¹ç•Œ** - æ­£ç¡®å¤„ç†æœåŠ¡ç«¯ç»„ä»¶å’Œå®¢æˆ·ç«¯ç»„ä»¶çš„å…³ç³»

è¿™ä¸ªç»„ç»‡ç»“æ„ç¡®ä¿äº†ï¼š

- ğŸ“ ä»£ç ç»„ç»‡æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤
- ğŸ” ç»„ä»¶æ˜“äºæŸ¥æ‰¾å’Œå®šä½
- ğŸ”„ æ”¯æŒç»„ä»¶å¤ç”¨è€Œä¸é€ æˆæ··ä¹±
- ğŸ“š æ–°å›¢é˜Ÿæˆå‘˜å®¹æ˜“ç†è§£é¡¹ç›®ç»“æ„
- ğŸš€ ç¬¦åˆ Next.js 15 çš„æœ€ä½³å®è·µ
